@page "/ticket/edit/{TicketId:int}"
@using DomainModels
@using DomainModels.DB
@using System.Net.Http.Json
@inject HttpClient _httpClient


<MudTextField @bind-Value="ticket.Title" Label="Ticket title" HelperText="Title" Variant="Variant.Outlined" />
<MudTextField @bind-Value="ticket.Description" Label="Ticket description" HelperText="Description" Variant="Variant.Outlined" />

<MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="() => AddTicketToDB()">Primary</MudButton>

<MudSelect T="string" Label="US States" MultiSelection="true" @bind-Value="value" @bind-SelectedValues="options">
    @foreach (var status in Status)
    {
        <MudSelectItem T="string" Value="@state">@state</MudSelectItem>
    }
</MudSelect>

@code {
    [Parameter]
    public int ticketId { get; set; }

    Ticket ticket = new();

    protected override async Task OnInitializedAsync()
    {
        await GetTicketFromDB();
    }

    public async Task GetTicketFromDB()
    {
        ticket = await _httpClient.GetFromJsonAsync<Ticket>($"https://localhost:7207/Ticket/{ticketId}");
    }

    public async Task PutTicketToDB()
    {
        await _httpClient.PutAsJsonAsync<Ticket>($"https://localhost:7207/Ticket/{ticketId}", ticket);
    }
}